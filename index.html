<!DOCTYPE html>
<html lang="en">
<head>
    <title>–ü–µ—Ä–≤—ã–π –∫–æ–¥-—Ä–µ–≤—å—é –ø—É–±–ª–∏—á–Ω—ã–π –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –í–µ–±/–ü—Ä–∞–∫—Ç–∏–∫ (Backend)</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="shower/themes/rndphp/styles/styles.css">
</head>
<body class="shower list">
<section class="slide preview">
    <div class="lines"></div>
    <div class="stripes"></div>
    <h1>–ü–µ—Ä–≤—ã–π –ø—É–±–ª–∏—á–Ω—ã–π –∫–æ–¥üëä—Ä–µ–≤—å—é –≤ –í–µ–±/–ü—Ä–∞–∫—Ç–∏–∫ </h1>
    <h1 style="
            text-align: center;
            margin: 47px;
            font-size: 73px;
            ">Baüí™kend </h1>
</section>

<section class="slide">
    <h2>–û —á–µ–º –ø–æ–≥–æ–≤–æ—Ä–∏–º</h2>
    <ul>
        <li class="next">–ß—Ç–æ —Ç–∞–∫–æ–µ –∏ –∑–∞—á–µ–º –∫–æ–¥-—Ä–µ–≤—å—é</li>
        <li class="next"></li>
        <li class="next"></li>
        <li class="next">–†–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã</li>
    </ul>
</section>

<section class="slide clear">
    <img src="pictures/17.png" class=" cover"/>
</section>


<!-- –°–ï–ö–¶–ò–Ø –ü–ï–¢–†–ê-->
<section class="slide">
    <h2 class="shout shrink">–°–µ–∫—Ü–∏—è –ü–µ—Ç—Ä–∞ –ö–ª–µ–Ω–∫–∏–Ω–∞</h2>
</section>
<section class="slide">
    <h1>–ü–ª–∞–Ω</h1>
    <ul>
        <li class="next">–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç - gge.ru</li>
        <li class="next">–°–ª—É—á–∞–π–Ω—ã–π –Ω–µ–¥–∞–≤–Ω–∏–π –∫–ª–∞—Å—Å - career.gge.ru</li>
        <li class="next">–°–ª—É—á–∞–π–Ω—ã–π –º–æ–¥—É–ª—å</li>
    </ul>
</section>
<section class="slide">
    <h1>–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç - gge.ru</h1>
    <ul>
        <li class="next">–°–º–æ—Ç—Ä–∏–º –∫–æ–¥</li>
        <li class="next">–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º —Å–∏—Ç—É–∞—Ü–∏—é –≤–æ–∫—Ä—É–≥</li>
        <li class="next">–ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ–º, –¥–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</li>
    </ul>
</section>
<section class="slide">
        <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code>
    class DocumentsList extends CBitrixComponent {
        private function getTitles(array $types): array
        {
            try {
                foreach ($types as $id => $values) {
                    $arTypeId[] = $id;
                }
                $items = ElementDocumentTypeTable::query()
                    ->setSelect(['ID', 'NAME', 'CODE'])
                    ->setFilter(['ID' => $arTypeId, '!CODE' => self::INSTRUCTION_CODE])
                    ->fetchCollection();
                foreach ($items as $item) {
                    $result[self::SORT_TYPE[$item->getCode()]] = [
                        'NAME'  => $item->getName(),
                        'ITEMS' => $types[$item->getId()],
                    ];
                }
                return $result;
            } catch (Exception $exception) {
                Log::channel('local')->warning(
                    $exception->getMessage(),
                    [
                        'error' => $exception->getTraceAsString(),
                    ]
                );

                return [];
            }
        }
    }
        </code></pre>
</section>
<section class="slide">
    <h1>–°–º–æ—Ç—Ä–∏–º –∫–æ–¥ - –ö–æ–Ω—Ç–µ–∫—Å—Ç</h1>
    <ul>
        <li class="next">–ö–ª–∞—Å—Å-–±–∏—Ç—Ä–∏–∫—Å–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç</li>
        <li class="next">–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–µ–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</li>
        <li class="next">–ú–µ—Ç–æ–¥ —Å–æ—Ä—Ç–∏—Ä—É–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–¥ —Ñ–æ—Ä–º–∞—Ç —Ç–µ–º–ø–ª–µ–π—Ç–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã</li>
        <li class="next">–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–º–º–∏—Ç–µ - self::SORT_TYPE[$item->getCode()]</li>
    </ul>
</section>
<section class="slide">
    <!--        <h1>–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç</h1>-->
    <pre style="font-weight: bold; font-family:monospace; font-size: 15px;"><code>
        private const SORT_TYPE = [
            'regulations' => 0,
            'templates'   => 1,
            'perechen-dokumentov' => 2,
        ];

        </code></pre>
</section>
<section class="slide">
    <h1>–í–æ–ø—Ä–æ—Å—ã –ø–æ —Å–∞–º–æ–º—É –∫–æ–º–º–∏—Ç—É</h1>
    <ul>
        <li class="next">–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ ID –∏–ª–∏ CODE –≤ –ë–î –ø–µ—Ä–µ—Å—Ç–∞–Ω—É—Ç —Å–æ–æ—Ç–≤–µ—Å—Ç–≤–æ–≤–∞—Ç—å self::SORT_TYPE?</li>
        <li class="next">–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –≤ self::SORT_TYPE –Ω–µ –±—É–¥–µ—Ç –∫–æ–¥–∞? –≠—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–∞—Å —É—Å—Ç—Ä–æ–∏—Ç?</li>
        <li class="next">Log::channel('local')->warning - ?</li>
    </ul>
</section>
<section class="slide">
    <h1>–í–æ–ø—Ä–æ—Å—ã –ø–æ –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –º–∏–Ω–∏-—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É</h1>
    <ul>
        <li class="next">getTitles - –Ω–µ —Å–∞–º–æ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–µ –∏–º—è –¥–ª—è –º–µ—Ç–æ–¥–∞-–∑–∞–ø—Ä–æ—Å–∞. –û–Ω–æ —Å–æ–≤—Å–µ–º –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ–¥ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—â–µ–µ –≤ —Ç–µ–ª–µ</li>
        <li class="next">–ü–æ—á–µ–º—É getTitles –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è –º—É—Ç–∞—Ü–∏–µ–π –≤—Ö–æ–¥—è—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥ —Ñ–∏–ª—å—Ç—Ä?</li>
        <li class="next">–ù—É–∂–Ω–æ –ª–∏ –Ω–∞–º –ª–æ–≤–∏—Ç—å –≤ try/catch –±–ª–æ–∫, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç –∏–∑ –ë–î, –Ω–µ –æ—à–∏–±–∫—É?</li>
    </ul>
</section>
<section class="slide">
    <h1>–°–ª—É—á–∞–π–Ω—ã–π –Ω–µ–¥–∞–≤–Ω–∏–π –∫–ª–∞—Å—Å - career.gge.ru</h1>
    <ul>
        <li class="next">–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º —Å–∏—Ç—É–∞—Ü–∏—é + –°–º–æ—Ç—Ä–∏–º –∫–æ–¥</li>
        <li class="next">–ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ–º, –¥–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</li>
    </ul>
</section>
<section class="slide">
        <pre style="font-weight: bold; font-family:monospace; font-size: 12px;"><code>
            class VacanciesService
            {

                private IblockVacancyRepository $iblockVacancyRepository;
                private HeadHunterRepository $headHunterRepository;
                private int $dateUpdate = 1;

                public function __construct()
                public function getVacancies(array $request): array
                private function createFilter(array|null $request): array
                public function importVacancies(): void
                public function importAllVacancies(): void
                private function createOrUpdateVacancies(array $vacancies): void
                private function needUpdateOrCreate(string $publishedAt): bool

            }
        </code></pre>
</section>
<section class="slide">
    <h1>–ß—Ç–æ —Å—Ä–∞–∑—É –±—Ä–æ—Å–∞–µ—Ç—Å—è –≤ –≥–ª–∞–∑–∞ - 1</h1>
    <pre style="font-weight: bold; font-family:monospace; font-size: 12px;"><code>
            private IblockVacancyRepository $iblockVacancyRepository;
            private HeadHunterRepository $headHunterRepository;

            public function __construct()
            {
                $this->iblockVacancyRepository = new IblockVacancyRepository();
                $this->headHunterRepository = new HeadHunterRepository();
            }
        </code></pre>
</section>

<section class="slide">
    <h1>–õ—É—á—à–µ –≤–Ω–µ–¥—Ä–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ</h1>
    <pre style="font-weight: bold; font-family:monospace; font-size: 10px;"><code>
            private IblockVacancyRepository $iblockVacancyRepository;
            private HeadHunterRepository $headHunterRepository;

            public function __construct(
                $iblockVacancyRepository: IblockVacancyRepository,
                $headHunterRepository: HeadHunterRepository
            )
            {
                $this->iblockVacancyRepository = $iblockVacancyRepository;
                $this->headHunterRepository = $headHunterRepository;
            }
        </code></pre>
</section>

<section class="slide">
    <h1>–ß—Ç–æ —Å—Ä–∞–∑—É –±—Ä–æ—Å–∞–µ—Ç—Å—è –≤ –≥–ª–∞–∑–∞ - 2</h1>
    <pre style="font-weight: bold; font-family:monospace; font-size: 12px;"><code>
                public function importVacancies(): void
                public function importAllVacancies(): void // unused
        </code></pre>
</section>
<section class="slide">
    <h1>–ß—Ç–æ —Å—Ä–∞–∑—É –±—Ä–æ—Å–∞–µ—Ç—Å—è –≤ –≥–ª–∞–∑–∞ - 2</h1>
    <pre style="font-weight: bold; font-family:monospace; font-size: 12px;"><code>
            public function importVacancies(): void
            {
                $arVacancy = $this->headHunterRepository->getListVacancies();
                if (count($arVacancy)) {
                    $this->createOrUpdateVacancies($arVacancy);
                }
            }
        </code></pre>
</section>
<section class="slide">
    <h1>–ß—Ç–æ —Å—Ä–∞–∑—É –±—Ä–æ—Å–∞–µ—Ç—Å—è –≤ –≥–ª–∞–∑–∞ - 2</h1>
    <pre style="font-weight: bold; font-family:monospace; font-size: 9px;"><code>
            class ImportVacanciesCommand extends Command
            {
                protected function configure(): void
                {
                    $this->setName('vacancies:import')
                        ->setDescription('Import vacancies from HH to Iblock');
                }
                protected function execute(InputInterface $input, OutputInterface $output): int
                {
                    $io = new SymfonyStyle($input, $output);
                    $io->writeln('–ò–º–ø–æ—Ä—Ç –≤–∞–∫–∞–Ω—Å–∏–π...');
                    (new VacanciesService())->importVacancies();
                    $io->newLine();
                    $io->writeln('–ò–º–ø–æ—Ä—Ç –≤–∞–∫–∞–Ω—Å–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω.');
                    return 0;
                }
            }
        </code></pre>
</section>
<section class="slide">
    <h1>–ß—Ç–æ —Å—Ä–∞–∑—É –±—Ä–æ—Å–∞–µ—Ç—Å—è –≤ –≥–ª–∞–∑–∞ - 2</h1>
    <ul>
        <li class="next">–•–æ—Ä–æ—à–∏ –ª–∏, —á—Ç–æ –º–µ—Ç–æ–¥ –∏–º–ø–æ—Ä—Ç–∞ –≤–∞–∫–∞–Ω—Å–∏–π –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–≤–µ—Ä—Ö?</li>
    </ul>
</section>
<section class="slide">
    <img class="cover" src="images/434242.jpg">
</section>
<section class="slide">
    <img class="cover" src="images/oVbhi8svVIs.jpg">
</section>
<section class="slide">
    <h1>–ß—Ç–æ —Å—Ä–∞–∑—É –±—Ä–æ—Å–∞–µ—Ç—Å—è –≤ –≥–ª–∞–∑–∞ - 2</h1>
    <ul>
        <li class="next"><s>–•–æ—Ä–æ—à–æ –ª–∏, —á—Ç–æ –º–µ—Ç–æ–¥ –∏–º–ø–æ—Ä—Ç–∞ –≤–∞–∫–∞–Ω—Å–∏–π –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–≤–µ—Ä—Ö?</s></li>
        <li class="next">–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–º –≤—ã–≥–ª—è–¥–∏—Ç –≥–ª–∞–≤–Ω—ã–π –º–µ—Ç–æ–¥ - createOrUpdate (upsert, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ–∂–µ –Ω–∏—á–µ–≥–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç, –Ω–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤)</li>
    </ul>
</section>
<section class="slide">
        <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code>
    private function createOrUpdateVacancies(array $vacancies): void
    {
        $ar = $this->iblockVacancyRepository->getIdsVacancies(['ACTIVE' => 'Y']);
        /** @var Vacancy $vacancy  */
        foreach ($vacancies as $vacancy) {
            try {
                if ($this->needUpdateOrCreate($vacancy['published_at'])) {
                    $vacancyDetail = $this->headHunterRepository->getDetailVacancy($vacancy['id']);
                    if (isset($ar[$vacancyDetail->xmlId])) {
                        $this->iblockVacancyRepository->updateVacancy($ar[$vacancyDetail->xmlId], $vacancyDetail);
                        unset($ar[$vacancyDetail->xmlId]);
                    } else {
                        $this->iblockVacancyRepository->createVacancy($vacancyDetail);
                    }
                } else {
                    unset($ar[$vacancy['id']]);
                }
            } catch (ArgumentException | SystemException $exception) {
                $message = sprintf('–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å\—Å–æ–∑–¥–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é : %s. –û—à–∏–±–∫–∞ : %s', $vacancy->xmlId, $exception->getMessage());
                Log::channel('local')->error($message);
            }
        }
        $this->iblockVacancyRepository->deactivateVacancies($ar);
    }
        </code></pre>
</section>
<section class="slide">
    <img class="cover" src="images/0QIMbuLSOg8.jpg">
</section>
<section class="slide">
    <img class="cover" src="images/HPeW9X3gCwQ.jpg">
</section>
<section class="slide">
    <img class="cover" src="images/HmFmfy0bRD0.jpg">
</section>

<!-- –°–ï–ö–¶–ò–Ø –ü–ï–¢–†–ê-->


<!-- –°–ï–ö–¶–ò–Ø –°–ï–†–û–ì–û-->
<section class="slide">
    <h2 class="shout shrink">–°–µ–∫—Ü–∏—è –°–µ—Ä–≥–µ—è –í–æ–ª–æ—à–∏–Ω–∞</h2>
</section>

<section class="slide">
    <h1 style="
    position: absolute;
    margin-left: 500px;
">–ù–∞—à –∫—Ä–∞—Å–∏–≤—ã–π –º–µ—Ç–æ–¥</h1>
    <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code style="
    margin-top: -50px;
">
    public function sendRequestForm($field, ?array $file): string
    {
        $object = Element::createObject();
        $newElement = $object->setName($field['name'])
            ->setCity($field['city'])
            ->setEmail($field['email'])

        $fid = null;
        if (is_array($file)) {
            $fid = CFile::SaveFile($file, '/file/');
            if ((int)$fid <= 0) {
                throw new Exception('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª', 400);
            }
            $newElement->setFile($fid);
        }

        $addResult = $newElement->save();

        $arEventFields = [
            'NAME'                    => $field['name'],
            'CITY'                    => $field['city'],
            'EMAIL'                   => $field['email'],
            'FILE'                    => $fid,
        ];

        $successMailSend = CEvent::Send('EDUCATIONAL_PROJECTS', 's1', $arEventFields);
        if (!$successMailSend) {
            throw new Exception('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø–∏—Å—å–º–∞', 400);
        }

        if (!$addResult->isSuccess()) {
            throw new Exception('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å', 400);
        }
        return 'success';
    }
        </code></pre>
</section>

<section class="slide">
    <h1>–ü—Ä–æ–±–ª–µ–º—ã:</h1>
    <ul>
        <li class="next">
        –ú–µ—Ç–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á: —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞, –æ—Ç–ø—Ä–∞–≤–∫—É email, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É</li>
        <li class="next">–ü–∞—Ä–∞–º–µ—Ç—Ä `$field` –Ω–µ –∏–º–µ–µ—Ç —Ç–∏–ø–∞, –Ω–µ—Ç –Ω–∏–∫–∞–∫–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∫–ª—é—á–µ–π –≤ –º–∞—Å—Å–∏–≤–µ</li>
        <li class="next">–í—Å–µ –æ—à–∏–±–∫–∏ –±—Ä–æ—Å–∞—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Å –∫–æ–¥–æ–º 400 (–ø—Ä–∏ —Ç–æ–º, —ç—Ç–æ http –∫–æ–¥), –Ω–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö —Ç–∏–ø–æ–≤ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π</li>
        <li class="next">–í–æ–∑–≤—Ä–∞—Ç —Å—Ç—Ä–æ–∫–∏ 'success' –Ω–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–µ–Ω (–∏ –¥–∞–∂–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)</li>
    </ul>
</section>

<section class="slide">
    <h1>–ù–µ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</h1>
    <ul>
        <li class="next">–Ω–µ—è—Å–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ `$fid`</li>
        <li class="next">–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ "–≤–µ–Ω–≥–µ—Ä—Å–∫–æ–π –Ω–æ—Ç–∞—Ü–∏–∏" `$arEventFields`</li>
        <li class="next">—Å–ª–∏—à–∫–æ–º –æ–±—â–µ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ `$field`</li>
    </ul>
</section>

<section class="slide">
    <h1>–î–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —Å–¥–µ–ª–∞—Ç—å –∫—Ä–∞—Å–∏–≤–æ</h1>
    <h3>–Ø –ø—Ä–µ–¥–ª–∞–≥–∞—é —Å–ª–µ–¥—É—é—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞:</h3>
    <ol>
        <li class="next">–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏</li>
        <li class="next">–°–æ–∑–¥–∞–Ω–∏–µ DTO –∫–ª–∞—Å—Å–∞ –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
        <li class="next">–£–ª—É—á—à–µ–Ω–∏–µ –∏–º–µ–Ω–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</li>
        <li class="next">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–≥–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–∏</li>
        <li class="next">–í—ã–Ω–µ—Å–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç</li>
    </ol>
</section>

<section class="slide">
    <h1 style="
    position: absolute;
    margin-left: 500px;
">–î–µ–ª–∞–µ–º DTO</h1>
    <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code>
    final class RequestDTO
    {
        public function __construct(
            public readonly string $name,
            public readonly string $city,
            public readonly string $email,
            public readonly ?array $file = null
        ) {}

        public static function fromArray(array $fields): self
        {
            return new self(
                name: $fields['name'],
                city: $fields['city'],
                email: $fields['email'],
            );
        }

        public function toEventFields(?int $fileId = null): array
        {
            return [
                'NAME' => $this->name,
                'CITY' => $this->city,
                'EMAIL' => $this->email,
                'FILE' => $fileId,
            ];
        }
    }
        </code></pre>
</section>

<section class="slide">
    <h1>–ë—É–¥—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞</h1>
    <p>–ù–∞–∫–∏–¥—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª–∞—Å—Å–∞. –°–Ω–∞—á–∞–ª–∞ —Ä–∞–∑–Ω–µ—Å–µ–º –º–µ—Ç–æ–¥—ã, –¥–∞–ª–µ–µ –ø—Ä–æ–π–¥–µ–º—Å—è –ø–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∫–æ–¥—É, –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫–∏–µ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã.</p>
</section>
<section class="slide">
    <h1 style="
    position: absolute;
    margin-left: 500px;
">–ë—É–¥—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞</h1>
    <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code style="
    margin-top: -50px;
">

class RequestFormService
{
    // –≤—ã–Ω–æ—Å–∏–º —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
    private const FILES_UPLOAD_DIR = '/files/';
    private const EVENT_TYPE = 'FORMS';
    private const SITE_ID = 's1';

    public function hanleRequestForm(array $fields, ?array $file): string
    {
        // –æ—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ
    }

    private function createRequestObject(RequestDTO $request): object
    {
        // —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–∞
    }

    private function processFile(?array $file): ?int
    {
        // —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
    }

    private function saveElement(object $element): int
    {
        // —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞
    }

    private function sendNotification(RequestDTO $request, ?int $fileId): void
    {
        // –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    }
}
        </code></pre>
</section>

<section class="slide">
    <h1>–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ handleRequestForm</h1>
    <p>–í —ç—Ç–æ–º –º–µ—Ç–æ–¥–µ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫. –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ—Ç –º–µ—Ç–æ–¥–∞ –Ω–∏–∫–∞–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.</p>
    <p>–ï—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–±—â–∏–π –±–ª–æ–∫ try/catch, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π Exception.</p>
    <p>–û—Å—Ç–∞–≤–∏–º –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –≤–Ω–µ —Å–∫–æ–±–æ–∫, —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞. –ù–æ –Ω–µ –º–µ–Ω–µ–µ –≤–∞–∂–Ω–∞—è.</p>
    <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code>

    public function hanleRequestForm(array $fields, ?array $file): string
    {
        // DTO –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –¥–æ –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∏–º–µ–Ω–Ω–æ –µ–≥–æ, –∞ –Ω–µ –º–∞—Å—Å–∏–≤
        $request = RequestDTO::fromArray($fields);

        // —Å–æ–∑–¥–∞–µ–º –æ–±—ä–µ–∫—Ç
        $element = $this->createRequestObject($request);

        // —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–∞–π–ª
        $fileId = $this->processFile($file);
        if ($fileId !== null) {
            $element->setFile($fileId);
        }

        // —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –±–∞–∑—É
        $this->saveElement($element);
        // –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –ø–æ—á—Ç—É
        $this->sendNotification($request, $fileId);

        // –Ω–µ –±—É–¥–µ–º –≤ –ø—Ä–∏–º–µ—Ä–µ –æ–ø–∏—Å—ã–≤–∞—Ç—å –æ—à–∏–±–∫–∏
        return true;
    }
        </code></pre>
</section>

<section class="slide">
    <h1>–ú–µ—Ç–æ–¥ createRequestObject</h1>
    <p>–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ —ç–ª–µ–º–µ–Ω—Ç–∞. –ù–∞ –≤—Ö–æ–¥ –ø–µ—Ä–µ–¥–∞–µ–º —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.</p>
    <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code>
    private function createRequestObject(RequestDTO $dto): object
    {
        $object = Element::createObject();

        return $object->setName($dto->name)
            ->setCity($dto->city)
            ->setEmail($dto->email)
    }
        </code></pre>
</section>

<section class="slide">
    <h1>–ú–µ—Ç–æ–¥ processFile</h1>
    <p>–ú–µ—Ç–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–∞. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç, –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω.</p>
    <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code>
    private function processFile(?array $file): ?int
    {
        // —Ä–∞–Ω–Ω–∏–π –≤–æ–∑–≤—Ä–∞—Ç
        if (!is_array($file)) {
            return null;
        }

        $fileId = CFile::SaveFile($file, self::FILES_UPLOAD_DIR);
        if (!$fileId) {
            return null;
        }

        return $fileId;
    }
        </code></pre>
</section>

<section class="slide">
    <p>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ –≤ –±–∞–∑—É. –ó–¥–µ—Å—å —Ç–∞–∫–∂–µ –Ω–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫, –≤—Å—è –Ω–∞–¥–µ–∂–¥–∞ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–π try/catch –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ</p>
    <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code>
    private function saveElement(object $element): int
    {
        $result = $element->save();
        if (!$result->isSuccess()) {
            throw new Exception('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å', 400);
        }

        return $element->getId()
    }
        </code></pre>
</section>


<section class="slide">
    <p>–í –º–µ—Ç–æ–¥–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è CEvent::Send, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É, –æ–Ω —Ç–æ–ª—å–∫–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –±–∞–∑—É.</p>

    <p>–ü–æ—ç—Ç–æ–º—É –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —Ç—É—Ç –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ, –ø–æ –±–æ–ª—å—à–µ–π —á–∞—Å—Ç–∏.</p>
    <pre style="font-weight: bold; font-family:monospace; font-size: 8px;"><code>
    private function sendNotification(EducationRequestDTO $request, ?int $fileId): void
    {
        $success = CEvent::Send(
            self::EVENT_TYPE,
            self::SITE_ID,
            $request->toEventFields($fileId)
        );

        if (!$success) {
            throw new Exception('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø–∏—Å—å–º–∞', 400);
        }
    }
        </code></pre>
</section>

<section class="slide">
    <h1>–ß–µ–≥–æ –º—ã –¥–æ–±–∏–ª–∏—Å—å</h1>
    <ul>
        <li class="next">–õ–µ–≥—á–µ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —á–∞—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏</li>
        <li class="next">–ü—Ä–æ—â–µ –Ω–∞—Ö–æ–¥–∏—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å –æ—à–∏–±–∫–∏</li>
        <li class="next">–ü—Ä–æ—â–µ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</li>
        <li class="next">–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ DTO</li>
        <li class="next">–í –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</li>
        <li class="next">–ü–æ–Ω—è—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –º–µ—Ç–æ–¥–æ–≤ –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</li>
        <li class="next">–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞</li>
    </ul>
    <p>–ù–æ... –ú—ã –≤—Å–µ–≥–æ –ª–∏—à—å —Ä–∞—Å–∫–∏–¥–∞–ª–∏ –∫–æ–¥ –ø–æ –º–µ—Ç–æ–¥–∞–º. –û—Å–Ω–æ–≤–Ω–æ–π hanleRequestForm –≤—Å—ë –µ—â–µ –Ω–∞—Ä—É—à–∞–µ—Ç –ø—Ä–∏–Ω—Ü–∏–ø –µ–¥–∏–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏. –ö–ª–∞—Å—Å —Ç–æ–∂–µ, –≤ –æ–±—â–µ–º —Ç–æ.</p>
    <p>–ö–æ–Ω–µ—á–Ω–æ, –º–æ–∂–Ω–æ –ø–æ–π—Ç–∏ –¥–∞–ª—å—à–µ, —Ä–∞—Å–∫–∏–¥–∞—Ç—å –ª–æ–≥–∏–∫—É –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º –∫–ª–∞—Å—Å–∞–º, —Å–¥–µ–ª–∞—Ç—å —Ü–µ–ø–æ—á–∫—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, —á—Ç–æ–±—ã —Å–æ–±–ª—é—Å—Ç–∏ SRP.</p>
    <p>–ù–æ —ç—Ç–æ —É–∂–µ –±—É–¥–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–¥–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è. –î–ª—è —Ç–∞–∫–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞, –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, –æ–≤–µ—Ä-–∏–∑–±—ã—Ç–æ—á–Ω–æ.
    </p>
</section>


<!-- –°–ï–ö–¶–ò–Ø –ü–ï–¢–†–ê-->
<section class="slide">
    <pre style="line-height: 1; font-size: 19px; font-weight: bold; color: #2e3191; font-family: monospace;"
         class="place">
 ______  __                                        __
/\__  _\/\ \                                      /\ \
\/_/\ \/\ \ \___       __          __     ___     \_\ \
   \ \ \ \ \  _ `\   /'__`\      /'__`\ /' _ `\   /'_` \
    \ \ \ \ \ \ \ \ /\  __/     /\  __/ /\ \/\ \ /\ \L\ \
     \ \_\ \ \_\ \_\\ \____\    \ \____\\ \_\ \_\\ \___,_\
      \/_/  \/_/\/_/ \/____/     \/____/ \/_/\/_/ \/__,_ /

    </pre>
</section>

<div class="progress"></div>

<script src="shower/shower.min.js"></script>
<!-- Copyright ¬© 3000 Yours Truly, Famous Inc. -->

</body>
</html>
